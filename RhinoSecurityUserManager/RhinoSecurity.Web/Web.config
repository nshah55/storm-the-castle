<?xml version="1.0" encoding="utf-8"?>
<configuration>
  
	<configSections>
    <section name="monoRail" type="Castle.MonoRail.Framework.Configuration.MonoRailSectionHandler, Castle.MonoRail.Framework" />
    <section name="brail" type="Castle.MonoRail.Views.Brail.BrailConfigurationSection, Castle.MonoRail.Views.Brail" />
    <section name="activerecord" type="Castle.ActiveRecord.Framework.Config.ActiveRecordSectionHandler, Castle.ActiveRecord" />
  </configSections>
	
  <appSettings />
  <connectionStrings>
    <add name="DefaultDatabase" 
				 connectionString="Data Source=localhost;Initial Catalog=test;User Id=sa;Password=administrator" />
  </connectionStrings>
	
	<monoRail useWindsorIntegration="true" defaultUrlExtension="">
		<controllers>
			<assembly>Basic.Web</assembly>
		</controllers>
		<url useExtensions="false" />
		<viewEngine viewPathRoot="Views" 
								xhtmlRendering="true" 
								customEngine="Castle.MonoRail.Views.Brail.BooViewEngine, Castle.MonoRail.Views.Brail" />
	</monoRail>	
  
	<activerecord pluralizeTableNames="true">
    <config>
      <add key="connection.driver_class" value="NHibernate.Driver.SqlClientDriver" />
      <add key="dialect" value="NHibernate.Dialect.MsSql2000Dialect" />
      <add key="connection.provider" value="NHibernate.Connection.DriverConnectionProvider" />
      <add key="connection.connection_string_name" value="DefaultDatabase" />
			
			<add key="cache.provider_class" value="NHibernate.Caches.SysCache.SysCacheProvider,NHibernate.Caches.SysCache" />
			<add key="relativeExpiration" value="300" />
		</config>
  </activerecord>
  
	<brail debug="true" 
				 saveToDisk="false" 
				 saveDirectory="BrailGen" 
				 batch="false" 
				 commonScriptsDirectory="CommonScripts">
    <reference assembly="Castle.MonoRail.Framework" />
  </brail>
	
	<system.web>
		<authentication mode="Forms">
			<forms loginUrl="~/user/login"/>
		</authentication>
		<!--<siteMap enabled="true" defaultProvider="AspNetARSiteMapProvider">
			<providers>
				<add name="AspNetARSiteMapProvider" type="Basic.Web.Common.ARSiteMapProvider" securityTrimmingEnabled="true"/>
			</providers>
		</siteMap>-->	
		<httpHandlers>
			<add verb="*" path="*.rails" type="Castle.MonoRail.Framework.MonoRailHttpHandlerFactory, Castle.MonoRail.Framework"/>
			<!-- block direct user access to template files -->
			<add verb="*" path="*.sql" type="System.Web.HttpForbiddenHandler"/>
			<add verb="*" path="*.brail" type="System.Web.HttpForbiddenHandler"/>
			<add verb="*" path="*.brailjs" type="System.Web.HttpForbiddenHandler"/>			
		</httpHandlers>
		<httpModules>
			<add name="routing" type="Castle.MonoRail.Framework.Routing.RoutingModuleEx, Castle.MonoRail.Framework"/>
			<add name="PerRequestLifestyle" type="Castle.MicroKernel.Lifestyle.PerWebRequestLifestyleModule,Castle.MicroKernel" />
		</httpModules>
		<compilation debug="true"/>
	</system.web>
	
</configuration>